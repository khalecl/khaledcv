<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown to DOCX Converter</title>
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f7fa;
            min-height: 100vh;
        }

        .container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 50px 20px;
            text-align: center;
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 40px;
            font-weight: 700;
        }

        .header p {
            margin: 0;
            font-size: 18px;
            opacity: 0.95;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
        }

        .panel {
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #e8eef7;
            background-color: #fafbfc;
        }

        .panel-header h2 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .panel-header .info {
            font-size: 12px;
            color: #999;
        }

        textarea {
            flex: 1;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.6;
            border: none;
            outline: none;
            resize: none;
            background-color: #fafbfc;
        }

        .preview {
            flex: 1;
            padding: 20px;
            overflow: auto;
            font-size: 15px;
            line-height: 1.7;
        }

        .preview h1 {
            font-size: 28px;
            margin: 24px 0 16px;
            font-weight: 700;
            border-bottom: 3px solid #667eea;
            padding-bottom: 8px;
            color: #1a1a1a;
        }

        .preview h2 {
            font-size: 24px;
            margin: 20px 0 12px;
            font-weight: 600;
            color: #333;
        }

        .preview h3 {
            font-size: 20px;
            margin: 16px 0 10px;
            font-weight: 600;
            color: #555;
        }

        .preview h4, .preview h5, .preview h6 {
            margin: 12px 0 8px;
            font-weight: 600;
            color: #666;
        }

        .preview code {
            background-color: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 13px;
            color: #c7254e;
        }

        .preview pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 12px 0;
            font-size: 12px;
            line-height: 1.4;
        }

        .preview pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .preview blockquote {
            border-left: 4px solid #667eea;
            padding-left: 16px;
            margin-left: 0;
            margin-top: 12px;
            margin-bottom: 12px;
            color: #666;
            font-style: italic;
        }

        .preview table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            border: 1px solid #ddd;
        }

        .preview th {
            background-color: #f5f5f5;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #ddd;
        }

        .preview td {
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
        }

        .preview ul, .preview ol {
            margin-top: 8px;
            margin-bottom: 8px;
            padding-left: 24px;
        }

        .actions {
            display: flex;
            gap: 12px;
            padding: 20px;
            justify-content: center;
            background: white;
            border-top: 1px solid #e8eef7;
        }

        button {
            padding: 12px 32px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .convert-btn {
            background-color: #667eea;
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .convert-btn:hover:not(:disabled) {
            background-color: #5568d3;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .convert-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .clear-btn {
            background-color: white;
            color: #333;
            border: 1px solid #ddd;
        }

        .clear-btn:hover {
            background-color: #f5f5f5;
        }

        .message {
            padding: 12px 20px;
            margin: 0 20px 20px;
            border-radius: 6px;
            text-align: center;
        }

        .error {
            background-color: #fee;
            color: #c00;
        }

        .success {
            background-color: #efe;
            color: #0c0;
        }

        .footer {
            background-color: #e8eef7;
            padding: 30px 20px;
            border-top: 1px solid #d0d8e8;
            text-align: center;
        }

        .footer p {
            margin: 0 0 8px;
            font-size: 14px;
            color: #555;
        }

        .footer .subtext {
            font-size: 12px;
            color: #999;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üìù Markdown to DOCX Converter</h1>
            <p>Convert your markdown to Word documents with proper styles</p>
        </header>

        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <h2>Markdown Editor</h2>
                </div>
                <textarea id="editor" placeholder="Paste or write your markdown here..." spellcheck="false"># Document Title

## Heading 1

### Heading 2

This is normal paragraph text with some **bold** and *italic* formatting.

#### Code Example

```python
def hello_world():
    print("Hello World!")
```

#### Lists

1. First numbered item
2. Second numbered item
3. Third numbered item

Bullet points:
- First bullet
- Second bullet
- Third bullet

#### Table Example

| Column 1 | Column 2 | Column 3 |
|----------|----------|----------|
| Data 1   | Data 2   | Data 3   |
| Data 4   | Data 5   | Data 6   |

#### Blockquote

> This is a quote from someone important.
> It can span multiple lines.

---

End of document.</textarea>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <h2>Live Preview</h2>
                    <span class="info">How it will look in Word</span>
                </div>
                <div class="preview" id="preview"></div>
            </div>
        </div>

        <div id="message"></div>

        <div class="actions">
            <button class="convert-btn" id="convertBtn">‚¨áÔ∏è Download as DOCX</button>
            <button class="clear-btn" id="clearBtn">üóëÔ∏è Clear</button>
        </div>

        <footer class="footer">
            <p>üí° All markdown is converted to proper Word styles (Title, Heading 1, Heading 2, Normal, Quote, etc)</p>
            <p class="subtext">Built with Marked.js + JSZip | Proper Word Styles Applied</p>
        </footer>
    </div>

    <script>
        const editor = document.getElementById('editor');
        const preview = document.getElementById('preview');
        const convertBtn = document.getElementById('convertBtn');
        const clearBtn = document.getElementById('clearBtn');
        const messageEl = document.getElementById('message');

        // Update preview
        editor.addEventListener('input', () => {
            preview.innerHTML = marked.parse(editor.value);
        });

        // Initial preview
        preview.innerHTML = marked.parse(editor.value);

        // Clear
        clearBtn.addEventListener('click', () => {
            if (confirm('Clear all content?')) {
                editor.value = '';
                preview.innerHTML = '';
            }
        });

        function showMessage(text, type) {
            messageEl.className = 'message ' + type;
            messageEl.textContent = text;
            setTimeout(() => {
                messageEl.className = '';
                messageEl.textContent = '';
            }, 3000);
        }

        // Convert
        convertBtn.addEventListener('click', async () => {
            const markdown = editor.value.trim();
            if (!markdown) {
                showMessage('Please enter markdown content', 'error');
                return;
            }

            convertBtn.disabled = true;
            convertBtn.textContent = '‚è≥ Converting...';

            try {
                const docxBlob = await markdownToDocx(markdown);
                saveAs(docxBlob, 'document.docx');
                showMessage('‚úì Downloaded successfully!', 'success');
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error: ' + error.message, 'error');
            } finally {
                convertBtn.disabled = false;
                convertBtn.textContent = '‚¨áÔ∏è Download as DOCX';
            }
        });

        // Create valid DOCX with proper styles
        async function markdownToDocx(markdown) {
            const zip = new JSZip();

            // Required DOCX files
            zip.file('[Content_Types].xml', getContentTypes());
            zip.file('_rels/.rels', getRels());
            zip.file('word/_rels/document.xml.rels', getDocumentRels());
            zip.file('word/styles.xml', getStyles());
            zip.file('word/document.xml', getWordDocument(markdown));

            return await zip.generateAsync({ type: 'blob' });
        }

        function escapeXml(str) {
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&apos;');
        }

        function getContentTypes() {
            return '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>' +
                '<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">' +
                '<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>' +
                '<Default Extension="xml" ContentType="application/xml"/>' +
                '<Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>' +
                '<Override PartName="/word/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/>' +
                '</Types>';
        }

        function getRels() {
            return '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>' +
                '<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">' +
                '<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>' +
                '</Relationships>';
        }

        function getDocumentRels() {
            return '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>' +
                '<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">' +
                '<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>' +
                '</Relationships>';
        }

        function getStyles() {
            return '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>' +
                '<w:styles xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml">' +
                '<w:docDefaults>' +
                '<w:rPrDefault><w:rPr><w:rFonts w:ascii="Calibri" w:hAnsi="Calibri"/><w:sz w:val="22"/></w:rPr></w:rPrDefault>' +
                '<w:pPrDefault/>' +
                '</w:docDefaults>' +
                '<w:style w:type="paragraph" w:styleId="Normal"><w:name w:val="Normal"/><w:qFormat/></w:style>' +
                '<w:style w:type="paragraph" w:styleId="Title"><w:name w:val="Title"/><w:basedOn w:val="Normal"/><w:rPr><w:b/><w:sz w:val="56"/><w:color w:val="2F5496"/></w:rPr><w:pPr><w:spacing w:before="0" w:after="240"/><w:jc w:val="center"/></w:pPr></w:style>' +
                '<w:style w:type="paragraph" w:styleId="Heading1"><w:name w:val="Heading 1"/><w:basedOn w:val="Normal"/><w:rPr><w:b/><w:sz w:val="48"/><w:color w:val="2F5496"/></w:rPr><w:pPr><w:spacing w:before="240" w:after="120"/><w:outlineLvl w:val="0"/></w:pPr></w:style>' +
                '<w:style w:type="paragraph" w:styleId="Heading2"><w:name w:val="Heading 2"/><w:basedOn w:val="Normal"/><w:rPr><w:b/><w:sz w:val="40"/><w:color w:val="44546A"/></w:rPr><w:pPr><w:spacing w:before="200" w:after="100"/><w:outlineLvl w:val="1"/></w:pPr></w:style>' +
                '<w:style w:type="paragraph" w:styleId="Heading3"><w:name w:val="Heading 3"/><w:basedOn w:val="Normal"/><w:rPr><w:b/><w:sz w:val="32"/><w:color w:val="44546A"/></w:rPr><w:pPr><w:spacing w:before="150" w:after="80"/><w:outlineLvl w:val="2"/></w:pPr></w:style>' +
                '<w:style w:type="paragraph" w:styleId="Quote"><w:name w:val="Quote"/><w:basedOn w:val="Normal"/><w:rPr><w:i/><w:color w:val="404040"/></w:rPr><w:pPr><w:ind w:left="720"/><w:spacing w:before="100" w:after="100"/><w:left w:val="720"/><w:bdr w:val="single" w:sz="12" w:space="1" w:color="C0C0C0"/></w:pPr></w:style>' +
                '<w:style w:type="paragraph" w:styleId="Code"><w:name w:val="Code"/><w:basedOn w:val="Normal"/><w:rPr><w:rFonts w:ascii="Courier New" w:hAnsi="Courier New"/><w:color w:val="C65911"/><w:sz w:val="20"/></w:rPr><w:pPr><w:spacing w:before="100" w:after="100"/><w:shd w:fill="F2F2F2"/><w:bdr w:val="single" w:sz="6" w:space="1" w:color="E0E0E0"/></w:pPr></w:style>' +
                '<w:style w:type="paragraph" w:styleId="ListParagraph"><w:name w:val="List Paragraph"/><w:basedOn w:val="Normal"/></w:style>' +
                '</w:styles>';
        }

        function getWordDocument(markdown) {
            let xml = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>' +
                '<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" ' +
                'xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" ' +
                'xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing">' +
                '<w:body>';

            const lines = markdown.split('\n');
            let listType = null;
            let inTable = false;
            let tableRows = [];

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i];

                // Flush table if we were building one
                if (inTable && !line.includes('|')) {
                    xml += buildTable(tableRows);
                    tableRows = [];
                    inTable = false;
                }

                // Title (# followed by space)
                if (line.match(/^#\s/) && i === 0) {
                    const text = escapeXml(line.replace(/^#\s/, ''));
                    xml += '<w:p><w:pPr><w:pStyle w:val="Title"/></w:pPr><w:r><w:rPr><w:b/><w:sz w:val="56"/></w:rPr><w:t>' + text + '</w:t></w:r></w:p>';
                }
                // Heading 1 (##)
                else if (line.match(/^##\s/)) {
                    const text = escapeXml(line.replace(/^##\s/, ''));
                    xml += '<w:p><w:pPr><w:pStyle w:val="Heading1"/></w:pPr><w:r><w:rPr><w:b/><w:sz w:val="48"/></w:rPr><w:t>' + text + '</w:t></w:r></w:p>';
                }
                // Heading 2 (###)
                else if (line.match(/^###\s/)) {
                    const text = escapeXml(line.replace(/^###\s/, ''));
                    xml += '<w:p><w:pPr><w:pStyle w:val="Heading2"/></w:pPr><w:r><w:rPr><w:b/><w:sz w:val="40"/></w:rPr><w:t>' + text + '</w:t></w:r></w:p>';
                }
                // Heading 3 (####)
                else if (line.match(/^####\s/)) {
                    const text = escapeXml(line.replace(/^####\s/, ''));
                    xml += '<w:p><w:pPr><w:pStyle w:val="Heading3"/></w:pPr><w:r><w:rPr><w:b/><w:sz w:val="32"/></w:rPr><w:t>' + text + '</w:t></w:r></w:p>';
                }
                // Ordered lists
                else if (line.match(/^\d+\.\s/)) {
                    const text = escapeXml(line.replace(/^\d+\.\s/, ''));
                    xml += '<w:p><w:pPr><w:pStyle w:val="ListParagraph"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr><w:spacing w:after="100"/></w:pPr><w:r><w:t>' + text + '</w:t></w:r></w:p>';
                }
                // Unordered lists (bullets)
                else if (line.match(/^[\*\-\+]\s/)) {
                    const text = escapeXml(line.replace(/^[\*\-\+]\s/, ''));
                    xml += '<w:p><w:pPr><w:pStyle w:val="ListParagraph"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="2"/></w:numPr><w:spacing w:after="100"/></w:pPr><w:r><w:t>' + text + '</w:t></w:r></w:p>';
                }
                // Blockquotes
                else if (line.match(/^>\s/)) {
                    const text = escapeXml(line.replace(/^>\s/, ''));
                    xml += '<w:p><w:pPr><w:pStyle w:val="Quote"/></w:pPr><w:r><w:rPr><w:i/></w:rPr><w:t>' + text + '</w:t></w:r></w:p>';
                }
                // Code blocks
                else if (line.trim().startsWith('```')) {
                    i++;
                    const code = [];
                    while (i < lines.length && !lines[i].trim().startsWith('```')) {
                        code.push(escapeXml(lines[i]));
                        i++;
                    }
                    xml += '<w:p><w:pPr><w:pStyle w:val="Code"/></w:pPr><w:r><w:rPr><w:rFonts w:ascii="Courier New"/></w:rPr><w:t>' + code.join('\n') + '</w:t></w:r></w:p>';
                }
                // Tables
                else if (line.includes('|')) {
                    inTable = true;
                    const cells = line.split('|').filter(c => c.trim() && !c.match(/^-+$/));
                    if (cells.length > 0) {
                        tableRows.push(cells.map(c => c.trim()));
                    }
                }
                // Horizontal rule
                else if (line.match(/^---+$/)) {
                    xml += '<w:p><w:pPr><w:pBdr><w:bottom w:val="single" w:sz="12" w:space="1" w:color="C0C0C0"/></w:pBdr></w:pPr><w:r></w:r></w:p>';
                }
                // Normal paragraph
                else if (line.trim()) {
                    xml += '<w:p><w:pPr><w:pStyle w:val="Normal"/></w:pPr><w:r><w:t>' + escapeXml(line) + '</w:t></w:r></w:p>';
                }
            }

            // Flush remaining table
            if (inTable && tableRows.length > 0) {
                xml += buildTable(tableRows);
            }

            xml += '</w:body></w:document>';
            return xml;
        }

        function buildTable(rows) {
            if (rows.length === 0) return '';

            let xml = '<w:tbl><w:tblPr><w:tblW w:w="5000" w:type="auto"/><w:tblBorders>' +
                '<w:top w:val="single" w:sz="12" w:space="0" w:color="auto"/>' +
                '<w:left w:val="single" w:sz="12" w:space="0" w:color="auto"/>' +
                '<w:bottom w:val="single" w:sz="12" w:space="0" w:color="auto"/>' +
                '<w:right w:val="single" w:sz="12" w:space="0" w:color="auto"/>' +
                '<w:insideH w:val="single" w:sz="12" w:space="0" w:color="auto"/>' +
                '<w:insideV w:val="single" w:sz="12" w:space="0" w:color="auto"/>' +
                '</w:tblBorders></w:tblPr>';

            rows.forEach((row, rowIndex) => {
                xml += '<w:tr>';
                row.forEach(cell => {
                    const shading = rowIndex === 0 ? ' <w:shd w:fill="D9E1F2"/>' : '';
                    xml += '<w:tc><w:tcPr>' + shading + '</w:tcPr><w:p><w:r><w:t>' + escapeXml(cell) + '</w:t></w:r></w:p></w:tc>';
                });
                xml += '</w:tr>';
            });

            xml += '</w:tbl>';
            return xml;
        }
    </script>
</body>
</html>
